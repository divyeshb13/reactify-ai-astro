---
import "@/styles/global.css";
import "react-toastify/dist/ReactToastify.css";
import "aos/dist/aos.css";
import "lenis/dist/lenis.css";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";

import BackToTop from "@/components/common/BackToTop.astro";
import ThemedToastContainer from "@/components/interactive/common/ThemedToastContainer";

interface Props {
  title?: string;
  description?: string;
}

const {
  title = "ReactifyAI - AI Startup & Tech Innovation",
  description = "ReactifyAI is a modern AI Startup & Tech Innovation website designed for AI companies, tech startups, and data-driven businesses. Built with clean code, responsive design, and sleek animations.",
} = Astro.props;
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="/images/favicon.svg" />
    <link rel="apple-touch-icon" href="/images/favicon.png" />

    <title>{title}</title>

    <meta name="description" content={description} />
    <meta name="author" content="ReactifyAI" />
    <meta
      name="keywords"
      content="AI, Tech Innovation, artificial intelligence, machine learning, automation, data analytics, business transformation"
    />

    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />

    <!-- Google Fonts Optimized Loading (non-blocking) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="dns-prefetch" href="https://fonts.gstatic.com" />
    <link
      rel="preload"
      as="style"
      href="https://fonts.googleapis.com/css2?family=Geist:wght@100..900&display=swap"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Geist:wght@100..900&display=swap"
      rel="stylesheet"
      media="print"
      onload="this.media='all'"
    />
    <noscript>
      <link
        href="https://fonts.googleapis.com/css2?family=Geist:wght@100..900&display=swap"
        rel="stylesheet"
      />
    </noscript>

    <!-- Theme Script - Runs IMMEDIATELY before page renders to prevent flash -->
    <script is:inline>
      (function () {
        const THEME_KEY = "theme";

        // Get theme from localStorage or system preference
        const getInitialTheme = () => {
          const stored = localStorage.getItem(THEME_KEY);
          if (stored === "light" || stored === "dark") {
            return stored;
          }

          // Fallback to system preference
          if (
            window.matchMedia &&
            window.matchMedia("(prefers-color-scheme: dark)").matches
          ) {
            return "dark";
          }

          return "dark"; // Default to dark
        };

        const theme = getInitialTheme();

        // Apply theme IMMEDIATELY
        if (theme === "dark") {
          document.documentElement.classList.add("dark");
        } else {
          document.documentElement.classList.remove("dark");
        }
      })();
    </script>
  </head>

  <body class="min-h-screen bg-background text-sm sm:text-base">
    <!-- Toast Notifications (React Island) -->
    <ThemedToastContainer client:idle />

    <!-- Header -->
    <Header />

    <!-- Page Content -->
    <main>
      <slot />
    </main>

    <!-- Footer -->
    <Footer />

    <!-- Back To Top Button (Astro Component) -->
    <BackToTop />
    <script>
      import "../scripts/layout";
    </script>
  </body>
</html>
