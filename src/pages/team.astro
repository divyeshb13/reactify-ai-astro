---
export const prerender = true;
import Layout from "@/layouts/Layout.astro";
import Heading from "@/components/common/Heading.astro";
import BgGlow from "@/components/background_animation/BgGlow.astro";
import NeuralLine from "@/components/background_animation/NeuralLine.astro";
import TeamCard from "@/components/cards/TeamCard.astro";
import { team as staticTeam } from "@/utils/const";
import { client } from "@/lib/sanity";
import { urlFor } from "@/lib/image";
import type { ITeamMember } from "@/utils/types";

// Fetch team members from Sanity
let team = staticTeam;
try {
  const data = await client.fetch<ITeamMember[]>(
    `*[_type == "team"] | order(order asc)`,
  );
  if (data && data.length > 0) {
    team = data.map((member, index) => ({
      name: member.name,
      role: member.role,
      image: member.image
        ? urlFor(member.image).width(200).height(200).url()
        : staticTeam[index]?.image || staticTeam[0]?.image || "",
      bio: member.bio,
      social: {
        linkedin: member.social?.linkedin || "#",
        x: member.social?.x || "#",
        github: member.social?.github || "#",
      },
    }));
  }
} catch (error) {
  console.error("Error fetching team members:", error);
}
---

<Layout title="Our Team - ReactifyAI">
  <section class="py-10 sm:py-20 sm:pt-40 pt-32 relative overflow-hidden">
    <!-- Background Elements -->
    <BgGlow
      variant="primary"
      size="lg"
      positionClass="top-0 right-0"
      opacity={0.1}
    />
    <BgGlow
      variant="secondary"
      size="lg"
      positionClass="bottom-0 left-0"
      opacity={0.1}
    />

    <div class="container mx-auto relative z-10 flex flex-col gap-8 sm:gap-16">
      <!-- Header -->
      <Heading
        section="Our Team"
        title="Meet the Minds Behind"
        highlights="ReactifyAI"
        subtitle="Our team of AI experts, data scientists, and engineers are dedicated to delivering innovative solutions that transform businesses and drive real results."
      />

      <!-- Team Grid -->
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-5 sm:gap-8">
        {
          team.map((member, index) => (
            <TeamCard
              name={member.name}
              role={member.role}
              image={member.image}
              bio={member.bio}
              social={member.social}
              index={index}
            />
          ))
        }
      </div>
    </div>
    <NeuralLine />
  </section>
</Layout>
