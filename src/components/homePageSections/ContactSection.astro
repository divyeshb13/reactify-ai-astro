---
import { Badge } from "@/components/interactive/ui/badge";
import { contactInfo as staticContactInfo } from "@/utils/const";
import NeuralLine from "@/components/background_animation/NeuralLine.astro";
import BgGlow from "@/components/background_animation/BgGlow.astro";
import ContactForm from "@/components/interactive/forms/ContactForm";
import { client } from "@/lib/sanity";
import { getIcon } from "@/utils/functions";

// Fetch contact info from Sanity
let contactInfo = staticContactInfo;
try {
  const data = await client.fetch(`*[_type == "contact"]`);
  if (data && data.length > 0) {
    contactInfo = data.map((item: any) => ({
      icon: getIcon(item.icon),
      label: item.label,
      value: item.value,
      href: item.href,
    }));
  }
} catch (error) {
  console.error("Error fetching contact info:", error);
}
---

<!-- Contact Section -->
<section id="contact" class="py-10 sm:py-20 relative overflow-hidden">
  <div class="container mx-auto z-10 relative">
    <div class="grid lg:grid-cols-2 gap-8 sm:gap-16 items-center">
      <!-- Contact Info Column -->
      <div
        class="flex flex-col sm:gap-7 gap-5"
        data-aos="fade-right"
        data-aos-delay="300"
      >
        <Badge
          variant="outline"
          className="w-fit text-primary border-primary/30 -mb-2"
        >
          Get In Touch
        </Badge>
        <div class="flex flex-col gap-6">
          <h2 class="text-4xl md:text-5xl font-bold">
            Ready to{" "}
            <span
              class="bg-[image:var(--gradient-primary)] bg-clip-text text-transparent"
            >
              Transform
            </span>{" "}
            Your Business?
          </h2>

          <p class="text-base sm:text-lg text-muted-foreground leading-relaxed">
            Let's discuss how our AI solutions can help you achieve your goals
            and stay ahead of the competition. Our team is ready to guide you
            through your AI transformation journey.
          </p>
        </div>

        <!-- Contact Info -->
        <div class="flex flex-col gap-2 sm:gap-4">
          {
            contactInfo.map((info, index) => (
              <a
                href={info.href}
                class="flex items-center gap-2 sm:gap-4 p-2 sm:p-4 bg-card/50 backdrop-blur-xl border border-primary-foreground/10 hover:shadow-[var(--shadow-glass)] rounded-xl hover:scale-105 transition-all duration-300 group"
              >
                <div class="size-8 sm:size-12 rounded-xl bg-primary/10 flex items-center justify-center">
                  <info.icon className="size-4 sm:size-6 text-primary" />
                </div>
                <div>
                  <div class="text-sm text-muted-foreground">{info.label}</div>
                  <div class="sm:text-base text-sm font-semibold group-hover:text-primary transition-colors">
                    {info.value}
                  </div>
                </div>
              </a>
            ))
          }
        </div>
      </div>
      <!-- Contact Form Column -->
      <ContactForm client:visible />
    </div>
  </div>

  <!-- Background Elements -->
  <BgGlow
    variant="primary"
    size="lg"
    positionClass="top-0 right-0"
    opacity={0.1}
  />
  <BgGlow
    variant="secondary"
    size="lg"
    positionClass="bottom-0 left-0"
    opacity={0.1}
  />
  <NeuralLine />
</section>
<!-- End Contact Section -->
